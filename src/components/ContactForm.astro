---
// src/components/ContactForm.astro
import type { City } from '../types';

interface Props {
  city: City;
}

const { city } = Astro.props;

// URL Tally avec paramètres (à remplacer par votre vrai ID)
const tallyFormId = import.meta.env.TALLY_FORM_ID || 'ABC123';
const tallyURL = `https://tally.so/r/${tallyFormId}?ville=${city.slug}&source=${city.domain}&utm_source=website&utm_medium=form&utm_campaign=${city.slug}`;
---

<section id="formulaire" class="py-16 md:py-24 bg-white">
  <div class="container mx-auto px-4 max-w-4xl">
    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-6 text-center">
      Demandez votre devis gratuit à {city.name}
    </h2>

    <p class="text-lg text-gray-600 text-center mb-12 max-w-2xl mx-auto">
      Remplissez le formulaire ci-dessous pour recevoir votre devis gratuit et personnalisé.
      Notre expert vous contactera sous <strong>24h</strong> pour planifier votre expertise humidité à {city.name}.
    </p>

    <div class="bg-gradient-to-br from-blue-50 to-white rounded-2xl shadow-2xl p-8 border border-blue-100">
      <!-- Iframe Tally -->
      <iframe
        src={tallyURL}
        width="100%"
        height="600"
        frameborder="0"
        marginheight="0"
        marginwidth="0"
        title={`Formulaire de contact - Expert Humidité ${city.name}`}
        loading="lazy"
        class="rounded-lg"
      ></iframe>
    </div>

    <!-- Réassurance -->
    <div class="mt-8 flex flex-col md:flex-row justify-center items-center gap-6 text-center">
      <div class="flex items-center gap-2 text-gray-600">
        <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
        </svg>
        <span class="text-sm font-medium">Vos données sont protégées</span>
      </div>

      <div class="flex items-center gap-2 text-gray-600">
        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="text-sm font-medium">Sans engagement</span>
      </div>

      <div class="flex items-center gap-2 text-gray-600">
        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
        <span class="text-sm font-medium">Réponse en 24h</span>
      </div>
    </div>
  </div>
</section>
